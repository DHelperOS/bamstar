# ğŸ“± BamStar ë§¤ì¹­ ì‹œìŠ¤í…œ êµ¬í˜„ ê°€ì´ë“œ

## ğŸ¯ í•µì‹¬ ì›ì¹™
- **Member(ìŠ¤íƒ€)ëŠ” Place(í”Œë ˆì´ìŠ¤)ë§Œ ì¡°íšŒ ê°€ëŠ¥**
- **Place(í”Œë ˆì´ìŠ¤)ëŠ” Member(ìŠ¤íƒ€)ë§Œ ì¡°íšŒ ê°€ëŠ¥**
- **ì±„íŒ… íƒ­ì€ ì œì™¸** (ì´ë¯¸ ë„¤ë¹„ê²Œì´ì…˜ë°”ì— ì¡´ì¬)

## ğŸ“Š ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          BamStar ë§¤ì¹­ ì‹œìŠ¤í…œ           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     Navigation Bar (Bottom)            â”‚
â”œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ì¶”ì²œâ”‚íƒìƒ‰â”‚ì§€ë„â”‚í•˜íŠ¸â”‚ì¦ê²¨ì°¾ê¸°         â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—‚ï¸ íƒ­ êµ¬ì¡° ìƒì„¸ ì„¤ê³„

### 1ï¸âƒ£ ì¶”ì²œ íƒ­ (AI ë§¤ì¹­)

#### **ê¸°ëŠ¥ ëª…ì„¸**
- AI ë§¤ì¹­ ì ìˆ˜ ê¸°ë°˜ ì¹´ë“œ ìŠ¤ì™€ì´í”„
- Member â†’ Place í”„ë¡œí•„ë§Œ í‘œì‹œ
- Place â†’ Member í”„ë¡œí•„ë§Œ í‘œì‹œ

#### **ì¹´ë“œ ë””ìì¸**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        [í”„ë¡œí•„ ì´ë¯¸ì§€]          â”‚
â”‚         â— â— â—‹ â—‹ â—‹              â”‚ â† ì´ë¯¸ì§€ ì¸ë””ì¼€ì´í„°
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ë§¤ì¹­ì ìˆ˜: 92ì  â­â­â­â­â­         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [FOR MEMBER VIEW]               â”‚
â”‚ ì¹´í˜ ë¸ë¼ë£¨ë‚˜ | ê°•ë‚¨ì           â”‚
â”‚ ğŸ“ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™ (2.3km)       â”‚
â”‚ ğŸ’° ì‹œê¸‰ 13,000-15,000ì›        â”‚
â”‚ ğŸ“… í‰ì¼/ì£¼ë§ í˜‘ì˜ê°€ëŠ¥          â”‚
â”‚ ğŸ·ï¸ #ë¼ë–¼ì•„íŠ¸êµìœ¡ #ì‹ì‚¬ì œê³µ    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [FOR PLACE VIEW]                â”‚
â”‚ ê¹€ë¯¼ìˆ˜ | ë°”ë¦¬ìŠ¤íƒ€ 3ë…„ì°¨        â”‚
â”‚ ğŸ“ ê°•ë‚¨êµ¬ ê±°ì£¼                 â”‚
â”‚ ğŸ’° í¬ë§ì‹œê¸‰ 15,000ì›           â”‚
â”‚ ğŸ“… í‰ì¼ ì˜¤ì „ ê°€ëŠ¥              â”‚
â”‚ ğŸ·ï¸ #ë¼ë–¼ì•„íŠ¸ #ë¡œìŠ¤íŒ…ìê²©ì¦    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   âŒ      â­      â¤ï¸      ğŸ‘ï¸   â”‚
â”‚  íŒ¨ìŠ¤  ì¦ê²¨ì°¾ê¸°  ì¢‹ì•„ìš”   ìƒì„¸  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **ì œìŠ¤ì²˜ ì¸í„°ë™ì…˜**
```dart
// ìŠ¤ì™€ì´í”„ ì•¡ì…˜ ì •ì˜
onHorizontalDragEnd: (details) {
  if (details.velocity.pixelsPerSecond.dx > threshold) {
    // ì˜¤ë¥¸ìª½ ìŠ¤ì™€ì´í”„ â†’ ì¢‹ì•„ìš”
    _sendLike(currentProfile);
  } else if (details.velocity.pixelsPerSecond.dx < -threshold) {
    // ì™¼ìª½ ìŠ¤ì™€ì´í”„ â†’ íŒ¨ìŠ¤
    _passProfile(currentProfile);
  }
}

onVerticalDragEnd: (details) {
  if (details.velocity.pixelsPerSecond.dy < -threshold) {
    // ìœ„ë¡œ ìŠ¤ì™€ì´í”„ â†’ ì¦ê²¨ì°¾ê¸°
    _addToFavorites(currentProfile);
  }
}
```

### 2ï¸âƒ£ íƒìƒ‰ íƒ­ (í•„í„°ë§ ê²€ìƒ‰)

#### **í•„í„° ì‹œìŠ¤í…œ**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ğŸ” ìŠ¤ë§ˆíŠ¸ í•„í„° í”„ë¦¬ì…‹      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ğŸ”¥ ì˜¤ëŠ˜ì˜ ì¶”ì²œ] [ğŸ“ ë‚´ ì§€ì—­]  â”‚
â”‚ [ğŸ’ í”„ë¦¬ë¯¸ì—„] [ğŸš€ ì¦‰ì‹œ ê°€ëŠ¥]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      âš™ï¸ ìƒì„¸ í•„í„°              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“ ì§€ì—­: [ê°•ë‚¨êµ¬ â–¼] + 2km     â”‚
â”‚ ğŸ’° ê¸‰ì—¬: â‚©12,000 â”â”â”â—â”â” â‚©20,000â”‚
â”‚ ğŸ“Š ê²½ë ¥: [ì‹ ì…] [1-3ë…„] [3ë…„+] â”‚
â”‚ ğŸ• ì‹œê°„: [ì˜¤ì „] [ì˜¤í›„] [ì €ë…]  â”‚
â”‚ ğŸ¢ ì—…ì¢…: [ì¹´í˜] [ìŒì‹ì ] [íŒë§¤]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **ê·¸ë¦¬ë“œ/ë¦¬ìŠ¤íŠ¸ í† ê¸€**
```dart
// ë³´ê¸° ëª¨ë“œ ì „í™˜
enum ViewMode { grid, list }

Widget _buildSearchResults() {
  return viewMode == ViewMode.grid 
    ? _buildGridView()  // 3ì—´ ê·¸ë¦¬ë“œ
    : _buildListView(); // ìƒì„¸ ë¦¬ìŠ¤íŠ¸
}
```

### 3ï¸âƒ£ ì§€ë„ íƒ­ (ë‚´ ì£¼ë³€)

#### **êµ¬í˜„ ê°€ëŠ¥ì„±: âœ… ì™„ì „ ê°€ëŠ¥**

##### **ê¸°ìˆ  ìŠ¤íƒ**
1. **Flutter**: `google_maps_flutter` íŒ¨í‚¤ì§€
2. **Supabase**: PostGIS í™•ì¥ (ì´ë¯¸ latitude/longitude í•„ë“œ ì¡´ì¬)
3. **ì‹¤ì‹œê°„ ìœ„ì¹˜**: `geolocator` íŒ¨í‚¤ì§€

##### **êµ¬í˜„ ë°©ë²•**

```dart
// 1. ìœ„ì¹˜ ê¶Œí•œ ìš”ì²­
import 'package:geolocator/geolocator.dart';

Future<Position> _getCurrentLocation() async {
  bool serviceEnabled = await Geolocator.isLocationServiceEnabled();
  if (!serviceEnabled) {
    return Future.error('Location services are disabled.');
  }

  LocationPermission permission = await Geolocator.checkPermission();
  if (permission == LocationPermission.denied) {
    permission = await Geolocator.requestPermission();
  }
  
  return await Geolocator.getCurrentPosition();
}
```

```dart
// 2. ì§€ë„ ìœ„ì ¯ êµ¬í˜„
import 'package:google_maps_flutter/google_maps_flutter.dart';

class NearbyMapTab extends StatefulWidget {
  @override
  Widget build(BuildContext context) {
    return GoogleMap(
      initialCameraPosition: CameraPosition(
        target: LatLng(currentLat, currentLng),
        zoom: 14.0,
      ),
      markers: _markers,
      circles: {
        Circle(
          circleId: CircleId('searchRadius'),
          center: LatLng(currentLat, currentLng),
          radius: searchRadius * 1000, // km to meters
          fillColor: Colors.blue.withOpacity(0.1),
          strokeColor: Colors.blue,
        ),
      },
      onMapCreated: (GoogleMapController controller) {
        _controller.complete(controller);
        _loadNearbyMatches();
      },
    );
  }
}
```

```sql
-- 3. PostGIS ì¿¼ë¦¬ (Supabase)
CREATE OR REPLACE FUNCTION find_nearby_matches(
  p_user_id UUID,
  p_user_type TEXT,
  p_lat DOUBLE PRECISION,
  p_lng DOUBLE PRECISION,
  p_radius_km INTEGER DEFAULT 5
) RETURNS TABLE (
  match_id UUID,
  match_name TEXT,
  match_type TEXT,
  latitude DOUBLE PRECISION,
  longitude DOUBLE PRECISION,
  distance_km DOUBLE PRECISION,
  matching_score DECIMAL
) AS $$
BEGIN
  IF p_user_type = 'MEMBER' THEN
    -- MemberëŠ” Placeë§Œ ì¡°íšŒ
    RETURN QUERY
    SELECT 
      pp.user_id,
      pp.place_name,
      'PLACE'::TEXT,
      pp.latitude,
      pp.longitude,
      ST_Distance(
        ST_MakePoint(pp.longitude, pp.latitude)::geography,
        ST_MakePoint(p_lng, p_lat)::geography
      ) / 1000 AS distance_km,
      ms.total_score
    FROM place_profiles pp
    LEFT JOIN matching_scores ms ON 
      ms.place_user_id = pp.user_id AND 
      ms.member_user_id = p_user_id
    WHERE ST_DWithin(
      ST_MakePoint(pp.longitude, pp.latitude)::geography,
      ST_MakePoint(p_lng, p_lat)::geography,
      p_radius_km * 1000
    )
    ORDER BY distance_km ASC;
  ELSE
    -- PlaceëŠ” Memberë§Œ ì¡°íšŒ
    -- MemberëŠ” ì •í™•í•œ ì£¼ì†Œê°€ ì•„ë‹Œ ì„ í˜¸ ì§€ì—­ë§Œ ìˆìœ¼ë¯€ë¡œ
    -- areas í…Œì´ë¸”ê³¼ ì¡°ì¸í•˜ì—¬ ëŒ€ëµì  ìœ„ì¹˜ í‘œì‹œ
    RETURN QUERY
    SELECT 
      mp.user_id,
      u.nickname,
      'MEMBER'::TEXT,
      a.latitude,  -- ì§€ì—­ ì¤‘ì‹¬ì 
      a.longitude, -- ì§€ì—­ ì¤‘ì‹¬ì 
      ST_Distance(
        ST_MakePoint(a.longitude, a.latitude)::geography,
        ST_MakePoint(p_lng, p_lat)::geography
      ) / 1000 AS distance_km,
      ms.total_score
    FROM member_profiles mp
    JOIN users u ON mp.user_id = u.id
    JOIN member_preferred_area_groups mpag ON mp.user_id = mpag.member_user_id
    JOIN areas a ON mpag.area_id = a.id
    LEFT JOIN matching_scores ms ON 
      ms.member_user_id = mp.user_id AND 
      ms.place_user_id = p_user_id
    WHERE ST_DWithin(
      ST_MakePoint(a.longitude, a.latitude)::geography,
      ST_MakePoint(p_lng, p_lat)::geography,
      p_radius_km * 1000
    )
    ORDER BY distance_km ASC;
  END IF;
END;
$$ LANGUAGE plpgsql;
```

##### **ì§€ë„ UI ë””ìì¸**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ğŸ“ ë‚´ ìœ„ì¹˜ ì£¼ë³€ 5km          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                             â”‚ â”‚
â”‚ â”‚         [Google Map]        â”‚ â”‚
â”‚ â”‚     ğŸ“(ë‚˜)                  â”‚ â”‚
â”‚ â”‚   ğŸ¢  ğŸ¢   ğŸ¢              â”‚ â”‚ â† Place ë§ˆì»¤
â”‚ â”‚     ğŸ¢   ğŸ¢                â”‚ â”‚
â”‚ â”‚   ğŸ‘¤  ğŸ‘¤     ğŸ‘¤            â”‚ â”‚ â† Member ë§ˆì»¤
â”‚ â”‚                             â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ë°˜ê²½: [1km][3km][5km][10km] â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“ ì¹´í˜ ë¸ë¼ë£¨ë‚˜ (0.5km)    â”‚ â”‚
â”‚ â”‚    ë§¤ì¹­ë„ 89% | ì‹œê¸‰ 15,000 â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ ğŸ“ ìŠ¤íƒ€ë²…ìŠ¤ ì—­ì‚¼ì  (0.8km)  â”‚ â”‚
â”‚ â”‚    ë§¤ì¹­ë„ 85% | ì‹œê¸‰ 13,000 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

##### **ë§ˆì»¤ í´ëŸ¬ìŠ¤í„°ë§**
```dart
// ë§ì€ ë§ˆì»¤ ì²˜ë¦¬ë¥¼ ìœ„í•œ í´ëŸ¬ìŠ¤í„°ë§
import 'package:google_maps_cluster_manager/google_maps_cluster_manager.dart';

class PlaceClusterItem extends ClusterItem {
  final String placeId;
  final String placeName;
  final LatLng position;
  final int matchingScore;
  
  PlaceClusterItem({
    required this.placeId,
    required this.placeName,
    required this.position,
    required this.matchingScore,
  });
}

// í´ëŸ¬ìŠ¤í„° ë§¤ë‹ˆì € ì„¤ì •
ClusterManager<PlaceClusterItem> _clusterManager = ClusterManager(
  items,
  _updateMarkers,
  markerBuilder: _markerBuilder,
  levels: [1, 4.25, 6.75, 8.25, 11.5, 14.5, 16.0, 16.5, 20.0],
);
```

### 4ï¸âƒ£ í•˜íŠ¸ íƒ­ (ì¢‹ì•„ìš” ê´€ë¦¬)

#### **íƒ­ êµ¬ì¡°**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ë°›ì€(3) â”‚ ë³´ë‚¸(5) â”‚ ë§¤ì¹­(2)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ë°›ì€ ì¢‹ì•„ìš” ë¦¬ìŠ¤íŠ¸]            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ†• ì¹´í˜ ë¸ë¼ë£¨ë‚˜            â”‚ â”‚
â”‚ â”‚ 2ë¶„ ì „ | ë§¤ì¹­ë„ 92%         â”‚ â”‚
â”‚ â”‚ [ìˆ˜ë½] [ê±°ì ˆ] [í”„ë¡œí•„ ë³´ê¸°] â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ ìŠ¤íƒ€ë²…ìŠ¤ ê°•ë‚¨ì              â”‚ â”‚
â”‚ â”‚ 1ì‹œê°„ ì „ | ë§¤ì¹­ë„ 87%       â”‚ â”‚
â”‚ â”‚ [ìˆ˜ë½] [ê±°ì ˆ] [í”„ë¡œí•„ ë³´ê¸°] â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **ìƒíƒœ ê´€ë¦¬**
```dart
// ì¢‹ì•„ìš” ìƒíƒœ enum
enum HeartStatus {
  pending,   // ëŒ€ê¸°ì¤‘
  accepted,  // ìˆ˜ë½ë¨ (ìƒí˜¸ ë§¤ì¹­)
  rejected,  // ê±°ì ˆë¨
  expired    // ë§Œë£Œë¨ (7ì¼ í›„)
}

// ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
StreamBuilder<List<Heart>>(
  stream: supabase
    .from(userType == UserType.member ? 'place_hearts' : 'member_hearts')
    .stream(primaryKey: ['id'])
    .eq(userType == UserType.member 
      ? 'member_user_id' 
      : 'place_user_id', currentUserId),
  builder: (context, snapshot) {
    // UI ì—…ë°ì´íŠ¸
  }
);
```

### 5ï¸âƒ£ ì¦ê²¨ì°¾ê¸° íƒ­

#### **í´ë” ì‹œìŠ¤í…œ**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ ì „ì²´ (12) â”‚ + ìƒˆ í´ë”       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“ ê´€ì‹¬ìˆìŒ (5)                â”‚
â”‚ ğŸ“ ë©´ì ‘ì˜ˆì • (3)                â”‚
â”‚ ğŸ“ ë³´ë¥˜ (4)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ì¦ê²¨ì°¾ê¸° í”„ë¡œí•„ ê·¸ë¦¬ë“œ]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” ë‹¨ë°©í–¥ ë§¤ì¹­ ë¡œì§

### **í•µì‹¬ ê·œì¹™**
```typescript
// Edge Function: match-finder
if (userType === 'MEMBER') {
  // MemberëŠ” Placeë§Œ ì¡°íšŒ
  query = query.from('place_profiles')
} else if (userType === 'PLACE') {
  // PlaceëŠ” Memberë§Œ ì¡°íšŒ
  query = query.from('member_profiles')
}
```

### **Flutter êµ¬í˜„**
```dart
class MatchingService {
  final UserType currentUserType;
  
  Future<List<Profile>> getMatchingProfiles() async {
    if (currentUserType == UserType.member) {
      // Place í”„ë¡œí•„ë§Œ ë°˜í™˜
      return await _fetchPlaceProfiles();
    } else {
      // Member í”„ë¡œí•„ë§Œ ë°˜í™˜
      return await _fetchMemberProfiles();
    }
  }
  
  // í”„ë¡œí•„ íƒ€ì… ì²´í¬
  bool isValidProfileType(Profile profile) {
    if (currentUserType == UserType.member) {
      return profile.type == ProfileType.place;
    } else {
      return profile.type == ProfileType.member;
    }
  }
}
```

## ğŸ“± Flutter êµ¬í˜„ êµ¬ì¡°

### **ë””ë ‰í† ë¦¬ êµ¬ì¡°**
```
lib/
â”œâ”€â”€ screens/
â”‚   â””â”€â”€ matching/
â”‚       â”œâ”€â”€ matching_screen.dart          # ë©”ì¸ ì»¨í…Œì´ë„ˆ
â”‚       â”œâ”€â”€ tabs/
â”‚       â”‚   â”œâ”€â”€ recommendation_tab.dart   # ì¶”ì²œ íƒ­
â”‚       â”‚   â”œâ”€â”€ search_tab.dart          # íƒìƒ‰ íƒ­
â”‚       â”‚   â”œâ”€â”€ map_tab.dart             # ì§€ë„ íƒ­
â”‚       â”‚   â”œâ”€â”€ hearts_tab.dart          # í•˜íŠ¸ íƒ­
â”‚       â”‚   â””â”€â”€ favorites_tab.dart       # ì¦ê²¨ì°¾ê¸° íƒ­
â”‚       â”œâ”€â”€ widgets/
â”‚       â”‚   â”œâ”€â”€ matching_card.dart       # ë§¤ì¹­ ì¹´ë“œ
â”‚       â”‚   â”œâ”€â”€ filter_sheet.dart        # í•„í„° ë°”í…€ì‹œíŠ¸
â”‚       â”‚   â”œâ”€â”€ profile_modal.dart       # ìƒì„¸ í”„ë¡œí•„
â”‚       â”‚   â””â”€â”€ map_marker.dart          # ì§€ë„ ë§ˆì»¤
â”‚       â””â”€â”€ services/
â”‚           â”œâ”€â”€ matching_service.dart     # ë§¤ì¹­ ë¡œì§
â”‚           â”œâ”€â”€ location_service.dart     # ìœ„ì¹˜ ì„œë¹„ìŠ¤
â”‚           â””â”€â”€ heart_service.dart        # ì¢‹ì•„ìš” ê´€ë¦¬
```

### **ìƒíƒœ ê´€ë¦¬ (Riverpod)**
```dart
// ë§¤ì¹­ í”„ë¡œí•„ Provider
final matchingProfilesProvider = StreamProvider.family<List<Profile>, UserType>(
  (ref, userType) async* {
    final supabase = ref.read(supabaseProvider);
    
    yield* supabase.functions
      .invoke('match-finder', body: {
        'userId': currentUserId,
        'userType': userType.name,
      })
      .asStream()
      .map((response) => Profile.fromJsonList(response.data));
  },
);

// ìœ„ì¹˜ Provider
final currentLocationProvider = FutureProvider<Position>((ref) async {
  return await Geolocator.getCurrentPosition();
});

// í•„í„° ìƒíƒœ Provider
final filterStateProvider = StateNotifierProvider<FilterNotifier, FilterState>(
  (ref) => FilterNotifier(),
);
```

## ğŸ¨ UI/UX ê°€ì´ë“œë¼ì¸

### **ìƒ‰ìƒ ì‹œìŠ¤í…œ**
```dart
// ë§¤ì¹­ ì ìˆ˜ë³„ ìƒ‰ìƒ
Color getScoreColor(double score) {
  if (score >= 90) return Colors.green;      // 90+ ìµœê³  ë§¤ì¹­
  if (score >= 70) return Colors.amber;      // 70+ ì¢‹ì€ ë§¤ì¹­
  if (score >= 50) return Colors.orange;     // 50+ ë³´í†µ ë§¤ì¹­
  return Colors.grey;                        // 50- ë‚®ì€ ë§¤ì¹­
}

// ì•¡ì…˜ ë²„íŠ¼ ìƒ‰ìƒ
const heartColor = Color(0xFFFF6B6B);        // ì¢‹ì•„ìš”
const starColor = Color(0xFFFFD93D);         // ì¦ê²¨ì°¾ê¸°
const passColor = Color(0xFF95A5A6);         // íŒ¨ìŠ¤
```

### **ì• ë‹ˆë©”ì´ì…˜**
```dart
// ì¹´ë“œ ìŠ¤ì™€ì´í”„ ì• ë‹ˆë©”ì´ì…˜
AnimatedContainer(
  duration: Duration(milliseconds: 300),
  curve: Curves.easeOutBack,
  transform: Matrix4.identity()
    ..rotateZ(_swipeAngle)
    ..translate(_swipeOffset.dx, _swipeOffset.dy),
  child: MatchingCard(),
);

// ì¢‹ì•„ìš” í•˜íŠ¸ ì• ë‹ˆë©”ì´ì…˜
AnimatedScale(
  scale: _isLiked ? 1.2 : 1.0,
  duration: Duration(milliseconds: 200),
  child: Icon(Icons.favorite, color: heartColor),
);
```

## ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ìµœì í™”

### **ì¸ë±ìŠ¤ ì¶”ê°€**
```sql
-- ì§€ë„ ê²€ìƒ‰ìš© ê³µê°„ ì¸ë±ìŠ¤
CREATE INDEX idx_place_location 
ON place_profiles 
USING GIST (ST_MakePoint(longitude, latitude));

-- ë§¤ì¹­ ì ìˆ˜ ì¡°íšŒ ìµœì í™”
CREATE INDEX idx_matching_scores_member_sorted 
ON matching_scores(member_user_id, total_score DESC)
WHERE expires_at > NOW();

CREATE INDEX idx_matching_scores_place_sorted 
ON matching_scores(place_user_id, total_score DESC)
WHERE expires_at > NOW();
```

### **ìºì‹± ì „ëµ**
```dart
// ë©”ëª¨ë¦¬ ìºì‹±
class MatchingCache {
  static final Map<String, List<Profile>> _cache = {};
  static final Map<String, DateTime> _cacheTime = {};
  
  static const Duration cacheValidDuration = Duration(minutes: 5);
  
  static List<Profile>? get(String key) {
    if (_cacheTime[key] != null) {
      if (DateTime.now().difference(_cacheTime[key]!) < cacheValidDuration) {
        return _cache[key];
      }
    }
    return null;
  }
  
  static void set(String key, List<Profile> data) {
    _cache[key] = data;
    _cacheTime[key] = DateTime.now();
  }
}
```

## ğŸš€ êµ¬í˜„ ìš°ì„ ìˆœìœ„

### **Phase 1: í•µì‹¬ ê¸°ëŠ¥ (Week 1)**
1. âœ… ì¶”ì²œ íƒ­ (ì¹´ë“œ ìŠ¤ì™€ì´í”„)
2. âœ… ë‹¨ë°©í–¥ ë§¤ì¹­ ë¡œì§
3. âœ… ì¢‹ì•„ìš”/íŒ¨ìŠ¤ ê¸°ëŠ¥

### **Phase 2: íƒìƒ‰ ê¸°ëŠ¥ (Week 2)**
1. âœ… íƒìƒ‰ íƒ­ (í•„í„°ë§)
2. âœ… í•˜íŠ¸ íƒ­ (ì¢‹ì•„ìš” ê´€ë¦¬)
3. âœ… ì¦ê²¨ì°¾ê¸° ê¸°ëŠ¥

### **Phase 3: ì§€ë„ ê¸°ëŠ¥ (Week 3)**
1. âœ… ì§€ë„ íƒ­ êµ¬í˜„
2. âœ… ìœ„ì¹˜ ê¸°ë°˜ ê²€ìƒ‰
3. âœ… ë§ˆì»¤ í´ëŸ¬ìŠ¤í„°ë§

### **Phase 4: ìµœì í™” (Week 4)**
1. âœ… ì„±ëŠ¥ ìµœì í™”
2. âœ… ì• ë‹ˆë©”ì´ì…˜ ê°œì„ 
3. âœ… ì‚¬ìš©ì„± í…ŒìŠ¤íŠ¸

## ğŸ“ˆ ì„±ê³µ ì§€í‘œ

### **ê¸°ìˆ  ì§€í‘œ**
- ë§¤ì¹­ ì¿¼ë¦¬ ì‘ë‹µ: < 200ms
- ì§€ë„ ë§ˆì»¤ ë¡œë”©: < 1ì´ˆ
- ì•± í¬ë˜ì‹œìœ¨: < 0.1%

### **ì‚¬ìš©ì ì§€í‘œ**
- ì²« ë§¤ì¹­ê¹Œì§€: < 3ë¶„
- ì¼ì¼ í™œì„± ì‚¬ìš©ì: > 60%
- ì¢‹ì•„ìš” ì „í™˜ìœ¨: > 20%

## ğŸ”‘ í•µì‹¬ ì°¨ë³„í™” í¬ì¸íŠ¸

1. **ë‹¨ë°©í–¥ ë§¤ì¹­**: Memberâ†”Place ëª…í™•í•œ êµ¬ë¶„
2. **ì§€ë„ ê¸°ë°˜ íƒìƒ‰**: ì‹¤ì œ ê±°ë¦¬ ê³ ë ¤í•œ í˜„ì‹¤ì  ë§¤ì¹­
3. **íˆ¬ëª…í•œ ì ìˆ˜**: ë§¤ì¹­ ì´ìœ ë¥¼ ëª…í™•íˆ í‘œì‹œ
4. **ì¦ê²¨ì°¾ê¸° ì‹œìŠ¤í…œ**: ë¶€ë‹´ ì—†ëŠ” ê´€ì‹¬ í‘œí˜„
5. **ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸**: Supabase Realtime í™œìš©

ì´ êµ¬í˜„ ê°€ì´ë“œëŠ” **ê¸°ìˆ ì  ì‹¤í˜„ ê°€ëŠ¥ì„±**ê³¼ **ì‚¬ìš©ì ê²½í—˜**ì„ ëª¨ë‘ ê³ ë ¤í•˜ì—¬ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

ëª¨ë“  ê¸°ëŠ¥ì€ í˜„ì¬ Supabase ì¸í”„ë¼ì™€ Flutter ìƒíƒœê³„ì—ì„œ **100% êµ¬í˜„ ê°€ëŠ¥**í•˜ë©°, íŠ¹íˆ ì§€ë„ ê¸°ëŠ¥ì€ PostGISì™€ Google Mapsë¥¼ í™œìš©í•˜ì—¬ **ê³ ì„±ëŠ¥ ìœ„ì¹˜ ê¸°ë°˜ ì„œë¹„ìŠ¤**ë¥¼ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.